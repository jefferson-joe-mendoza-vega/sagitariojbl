<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <!-- SEO Básico -->
    <title>sagitariojbl - Tienda Online de JBL, Xiaomi y Más</title>
    <meta name="description" content="Compra productos de las mejores marcas como JBL, Xiaomi y más en sagitariojbl. Encuentra parlantes, auriculares, y muchos más artículos electrónicos.">
    <meta name="keywords" content="sagitariojbl, JBL, Xiaomi, parlantes, auriculares, tienda online, productos electrónicos, mejores precios, ofertas">
    <meta name="author" content="sagitariojbl">

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="sagitariojbl - Tu tienda online de productos electrónicos" />
    <meta property="og:description" content="Descubre una amplia variedad de productos JBL, Xiaomi y más. ¡Encuentra los mejores precios y ofertas en sagitariojbl!" />
    <meta property="og:image" content="https://i.ibb.co/swShCSf/image.png" />
    <meta property="og:url" content="https://www.sagitariojbl.web.app/" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="sagitariojbl" />

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="sagitariojbl - Tu tienda online de productos electrónicos">
    <meta name="twitter:description" content="Descubre una amplia variedad de productos JBL, Xiaomi y más. ¡Encuentra los mejores precios y ofertas en sagitariojbl!">
    <meta name="twitter:image" content="https://i.ibb.co/swShCSf/image.png">

    <!-- Schema.org Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Store",
      "name": "sagitariojbl",
      "image": "https://i.ibb.co/swShCSf/image.png",
      "@id": "https://www.sagitariojbl.web.app/",
      "url": "https://www.sagitariojbl.web.app",
      "description": "Compra productos de las mejores marcas como JBL, Xiaomi y más en sagitariojbl.",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Calle Ficticia 123",
        "addressLocality": "Ciudad",
        "addressRegion": "Provincia",
        "postalCode": "12345",
        "addressCountry": "PE"
      },
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+51 944654438",
        "contactType": "customer service"
      },
      "sameAs": [
        "https://www.facebook.com/share/1AJK56zFmt/?mibextid=qi2Omg",
        "https://wa.me/+51944654438",
        "https://www.tiktok.com/@.sagitario251?_t=8s3DdCyBMZB&_r=1"
      ]
    }
    </script>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-O+IT6IXFbqv7+TQ1rNqpAUuaNCWyBO6UVBd8i4OhS9nF6VfT8GNdTu5/c1LsiBfFl8J7LblrBYHY/u3XfHOo9w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <style>
        :root {
            /* Colores Neutros */
            --color-fondo: #f5f5f5;
            --color-blanco: #ffffff;
            --color-gris-claro: #f0f0f0;
            --color-gris: #333333;
            --color-gris-oscuro: #555555;

            /* Colores de Acento */
            --color-primario: #ff5722; /* Naranja Vibrante */
            --color-secundario: #00bfff; /* Azul Eléctrico */

            /* Colores de Texto */
            --color-texto: #333333;
            --color-texto-claro: #ffffff;

            /* Otros */
            --color-hover: #ffd700; /* Amarillo para hover */
        }

        html { scroll-behavior: smooth; }
        body {
            margin: 0;
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: var(--color-fondo);
            color: var(--color-texto);
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 1rem; }
        header {
            position: fixed; 
            top: 0; 
            width: 100%; 
            z-index: 1000;
            background: var(--color-blanco);
            color: var(--color-texto-claro);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .header-content {
            display: flex; 
            align-items: center; 
            justify-content: space-between;
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 1rem 2rem;
        }
        header .logo {
            font-weight: bold; 
            font-size: 1.5rem; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem;
            color: var(--color-primario);
        }
        header nav {
            flex: 1; 
            display: flex; 
            justify-content: center; 
            gap: 1.5rem;
        }
        /* Color de las letras del menú: naranja y al pasar el ratón negro */
        header nav a {
            color: var(--color-primario);
            text-decoration: none; 
            display: inline-flex; 
            align-items: center;
            gap:0.3rem; 
            font-size:0.95rem; 
            transition: color 0.2s ease;
        }
        header nav a:hover {
            color: #000; 
        }

        header .cart-button {
            cursor: pointer; 
            background: var(--color-secundario); 
            padding: 0.6rem 1rem; 
            border-radius: 50px;
            display: flex; 
            align-items: center; 
            gap:0.5rem; 
            transition: background 0.2s ease;
            font-size: 0.9rem; 
            color: var(--color-texto-claro);
        }
        header .cart-button i { font-size:1rem; }
        header .cart-button:hover { background: #009acd; /* Tono más oscuro de azul eléctrico */ }
        .content-offset { margin-top: 80px; }

        .banner {
            position: relative; 
            height: 300px; 
            margin-bottom: 2rem; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: var(--color-texto-claro); 
            overflow: hidden;
            text-shadow: 0px 0px 5px rgba(0,0,0,0.7);
        }
        .banner .banner-image-container {
            position: absolute; 
            top:0; 
            left:0; 
            width: 100%; 
            height: 100%; 
            z-index: -1;
        }
        .banner .banner-image-container img {
            position: absolute; 
            top:0; 
            left:0; 
            width: 100%; 
            height: 100%; 
            object-fit: cover; 
            opacity: 0; 
            transition: opacity 1s ease-in-out;
        }
        .banner .banner-image-container img.active { opacity: 1; }
        .banner h1 { font-size: 3rem; margin: 0; text-align: center; z-index: 1; }

        .filters {
            display: flex; 
            flex-wrap: wrap; 
            align-items: center; 
            justify-content: center;
            padding: 1rem; 
            gap: 1rem; 
            background: var(--color-blanco); 
            border-bottom: 1px solid #ccc;
        }
        .filters input, .filters select {
            padding: 0.5rem; 
            font-size: 1rem; 
            border-radius: 4px; 
            border: 1px solid #ccc;
        }
        .filters input:focus, .filters select:focus {
            outline: none; 
            border-color: #999;
        }

        .products {
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1.5rem; 
            padding: 2rem 0;
        }
        .product {
            border: 1px solid #ddd; 
            border-radius: 8px; 
            text-align: center; 
            padding: 1rem; 
            background: var(--color-blanco);
            display: flex; 
            flex-direction: column; 
            justify-content: space-between; 
            transition: box-shadow 0.3s, transform 0.3s;
            position: relative; 
            cursor: pointer;
        }
        .product:hover {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1); 
            transform: translateY(-3px);
        }
        .product img {
            max-width: 100%; 
            max-height: 150px; 
            object-fit: cover; 
            margin-bottom: 0.5rem; 
            border-radius: 4px;
        }
        .product h3 { 
            font-size: 1rem; 
            margin: 0.5rem 0; 
            color: var(--color-texto); 
        }
        .product .details {
            font-size: 0.85rem; 
            color: #666; 
            margin-bottom: 0.5rem; 
            line-height: 1.3;
        }
        .product .details div { margin-bottom: 0.25rem; }
        .product .price {
            margin: 0.5rem 0; 
            font-weight: bold; 
            font-size: 1rem; 
            color: var(--color-texto);
        }
        .product button {
            padding: 0.5rem 1rem; 
            background: var(--color-primario); 
            color: var(--color-texto-claro); 
            border: none; 
            border-radius: 50px; 
            cursor: pointer;
            margin-top: 0.5rem; 
            display: flex; 
            align-items: center; 
            gap:0.5rem; 
            transition: background 0.2s ease;
        }
        .product button i { font-size:1rem; }
        .product button:hover { background: var(--color-hover); }

        /* Skeleton CSS */
        .product.skeleton {
            animation: skeleton-loading 1.5s linear infinite alternate;
            background: var(--color-gris-claro);
        }
        .skeleton-image {
            width: 100%;
            height: 150px;
            background: #ddd;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        .skeleton-text {
            width: 100%;
            height: 15px;
            background: #ddd;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }
        .skeleton-text.short {
            width: 40%;
        }
        .skeleton-text.med {
            width: 70%;
        }
        .skeleton-button {
            width: 60%;
            height: 30px;
            background: #ddd;
            border-radius: 50px;
            margin: 0.5rem auto 0;
        }
        @keyframes skeleton-loading {
            0% { background-color: #ddd; }
            100% { background-color: #e0e0e0; }
        }

        .product-modal-overlay {
            position: fixed; 
            top:0; 
            left:0; 
            width:100%; 
            height:100vh; 
            background: rgba(0,0,0,0.5);
            display: none; 
            justify-content:center; 
            align-items:center; 
            z-index:2000;
        }
        .product-modal-overlay.open { display: flex; }
        .product-modal {
            background: var(--color-blanco); 
            border-radius: 8px; 
            max-width: 600px; 
            width: 90%; 
            padding: 2rem; 
            position: relative;
            display: flex; 
            flex-direction: column; 
            align-items: center;
        }
        .product-modal img {
            max-width: 200px; 
            max-height: 200px; 
            object-fit: cover; 
            margin-bottom: 1rem; 
            border-radius:4px;
        }
        .product-modal h2 {
            margin: 0.5rem 0; 
            font-size: 1.5rem; 
            color: var(--color-texto);
        }
        .product-modal .modal-details {
            font-size: 0.9rem; 
            color: #666; 
            margin: 1rem 0; 
            text-align:center;
        }
        .product-modal .modal-price {
            font-weight: bold; 
            font-size: 1.2rem; 
            margin: 1rem 0; 
            color: var(--color-texto);
        }
        .product-modal button {
            padding: 0.5rem 1rem; 
            background: var(--color-primario); 
            color: var(--color-texto-claro); 
            border: none; 
            border-radius:50px; 
            cursor: pointer;
            display: flex; 
            align-items:center; 
            gap:0.5rem; 
            transition: background 0.2s ease;
        }
        .product-modal button i { font-size:1rem; }
        .product-modal button:hover { background: var(--color-hover); }
        .close-product-modal {
            position: absolute; 
            top: 1rem; 
            right:1rem; 
            background: none; 
            border:none;
            font-size:1.5rem; 
            cursor: pointer; 
            color: var(--color-texto);
        }
        .close-product-modal:hover { color:#666; }

        .cart-modal {
            position: fixed; 
            top: 0; 
            right: 0; 
            width: 320px; 
            height: 100vh; 
            background: var(--color-blanco);
            box-shadow: -2px 0 10px rgba(0,0,0,0.1); 
            transform: translateX(100%); 
            transition: transform 0.3s ease;
            display: flex; 
            flex-direction: column; 
            z-index: 1000;
        }
        .cart-modal.open { transform: translateX(0); }
        .cart-modal-header {
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 1rem; 
            background: var(--color-primario); 
            color: var(--color-texto-claro);
        }
        .cart-modal-header h2 { margin: 0; font-size: 1.2rem; }
        .close-cart {
            background: none; 
            border: none; 
            color: var(--color-texto-claro); 
            font-weight: bold; 
            font-size: 1.5rem; 
            cursor: pointer;
        }
        .close-cart:hover { color: var(--color-hover); }
        .cart-items { 
            flex: 1; 
            overflow-y: auto; 
            padding: 1rem; 
        }
        .cart-item {
            display: flex; 
            align-items: center; 
            margin-bottom: 1rem;
        }
        .cart-item img {
            width: 50px; 
            height: 50px; 
            object-fit: cover; 
            margin-right: 1rem; 
            border-radius: 4px;
        }
        .cart-item p { 
            margin: 0; 
            font-size: 0.9rem; 
        }
        .cart-footer {
            padding: 1rem; 
            border-top: 1px solid #ccc;
        }
        .cart-footer button {
            width: 100%; 
            padding: 0.5rem; 
            background: var(--color-primario); 
            color: var(--color-texto-claro); 
            border: none; 
            border-radius: 50px; 
            cursor: pointer;
            display:flex; 
            align-items:center; 
            justify-content:center; 
            gap:0.5rem; 
            transition: background 0.2s ease;
        }
        .cart-footer button i { font-size:1rem; }
        .cart-footer button:hover { background: var(--color-hover); }

        .toast {
            position: fixed; 
            bottom: 20px; 
            right: 20px; 
            background: var(--color-gris); 
            color: var(--color-texto-claro);
            padding: 0.75rem 1rem; 
            border-radius: 4px; 
            opacity: 0; 
            transition: opacity 0.3s ease; 
            z-index: 3000; 
            font-size: 0.9rem;
        }
        .toast.show { opacity: 1; }

        .flying-img {
            position: fixed; 
            width: 50px; 
            height: 50px; 
            object-fit: cover; 
            border-radius: 4px; 
            z-index: 2000;
            transition: transform 1s ease-in-out; 
            pointer-events: none;
        }

        .contact-section {
            background: var(--color-blanco); 
            padding: 2rem 1rem; 
            border-top: 1px solid #ccc;
        }
        .contact-section h2 {
            text-align: center; 
            margin-bottom: 1rem; 
            font-size: 1.8rem; 
            color: var(--color-texto);
        }

        /* Íconos redondos en la sección de contacto */
        .contact-info {
            display: flex; 
            justify-content: center; 
            gap: 1rem; 
            max-width: 400px; 
            margin: 0 auto;
        }

        .icon-circle {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            text-decoration: none;
            color: #fff;
            font-size: 1.5rem;
            transition: transform 0.3s, background-color 0.3s;
        }
        .icon-circle:hover {
            transform: scale(1.1);
        }
        
        .icon-circle.whatsapp:hover {
            background-color: #20b954;
        }
        
        .icon-circle.facebook:hover {
            background-color: #145dbf;
        }
        
        .icon-circle.tiktok:hover {
            background-color: #444444;
        }

        footer { 
            background: var(--color-gris-claro); 
            padding: 1rem; 
            text-align: center; 
            font-size:0.9rem; 
            color: var(--color-texto); 
        }

        @media (max-width: 768px) {
            header nav { display: none; }
            .logo { font-size:1.2rem; }
            .products { grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); }
        }
        @media (max-width: 480px) {
            .filters { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <a href="#inicio">
                    <img src="https://i.ibb.co/swShCSf/image.png" alt="Logo de Mi Tienda" style="width:100px; height:40px;">
                </a>
            </div>
            <nav>
                <a href="#inicio"><i class="fas fa-home"></i> Inicio</a>
                <a href="#productos"><i class="fas fa-tags"></i> Productos</a>
                <a href="#contacto"><i class="fas fa-envelope"></i> Contacto</a>
            </nav>
            <div class="cart-button" id="cartButton">
                <i class="fas fa-shopping-cart"></i> Carrito (0)
            </div>
        </div>
    </header>
    

    <div class="content-offset" id="inicio"></div>
    <div class="banner">
        <div class="banner-image-container">
            <img src="https://www.fexcortes.com/wp-content/uploads/2023/12/estrategias-para-incrementar-ventas-en-navidad.jpg" class="active" alt="Imagen 1">
            <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/1e/JBL-Logo.svg/1200px-JBL-Logo.svg.png" alt="Imagen 2">
            <img src="https://logolook.net/wp-content/uploads/2022/10/Xiaomi-Logo.png" alt="Imagen 3">
        </div>
        <h1>Bienvenido a Mi Tienda</h1>
    </div>

    <div class="filters container" id="productos">
        <input type="text" id="searchInput" placeholder="Buscar productos...">
    </div>

    <!-- Contenedor de productos -->
    <section class="products" id="productsSection"></section>

    <div class="cart-modal" id="cartModal">
        <div class="cart-modal-header">
            <h2>Carrito</h2>
            <button class="close-cart" id="closeCartBtn">×</button>
        </div>
        <div class="cart-items" id="cartItems"></div>
        <div class="cart-footer">
            <button id="checkoutBtn"><i class="fas fa-credit-card"></i> Finalizar Compra</button>
        </div>
    </div>

    <div class="contact-section" id="contacto">
        <h2>Contáctanos</h2>
        <div class="contact-info">
            <a href="https://www.tiktok.com/@.sagitario251?_t=8s3DdCyBMZB&_r=1" target="_blank" class="icon-circle tiktok" title="TikTok">
                <i class="bi bi-tiktok" style="font-size: 2rem; color: black;"></i>
            </a>
            <a href="https://wa.me/+51944654438" target="_blank" class="icon-circle whatsapp" title="WhatsApp">
                <i class="bi bi-whatsapp" style="font-size: 2rem; color: green;"></i>
            </a>
            <a href="https://www.facebook.com/share/1AJK56zFmt/?mibextid=qi2Omg" target="_blank" class="icon-circle facebook" title="Facebook">
                <i class="bi bi-facebook" style="font-size: 2rem; color: blue;"></i>
            </a>
            
        </div>
    </div>

    <footer>
        <p>© 2024 Mi Tienda. Todos los derechos reservados.</p>
    </footer>

    <div id="toast" class="toast">Producto agregado al carrito!</div>

    <div class="product-modal-overlay" id="productModalOverlay">
        <div class="product-modal">
            <button class="close-product-modal" id="closeProductModalBtn">×</button>
            <img id="modalProductImg" src="" alt="Producto">
            <h2 id="modalProductName"></h2>
            <div class="modal-details" id="modalProductDetails"></div>
            <p class="modal-price" id="modalProductPrice"></p>
            <button id="modalAddToCartBtn"><i class="fas fa-cart-plus"></i> Agregar al carrito</button>
        </div>
    </div>

    <!-- Inicialización de Firebase -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
      import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-analytics.js";
      import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

      const firebaseConfig = {
            apiKey: "AIzaSyChf0sk1C3VZXHrJktR6gF1fKI-rfOKeEQ",
            authDomain: "sagitariojbl-f0b6e.firebaseapp.com",
            projectId: "sagitariojbl-f0b6e",
            storageBucket: "sagitariojbl-f0b6e.firebasestorage.app",
            messagingSenderId: "1045332569220",
            appId: "1:1045332569220:web:5d3ff225b3431a16e126d1",
            measurementId: "G-KL2BSJKQFG"
        };

      const app = initializeApp(firebaseConfig);
      getAnalytics(app);
      const db = getFirestore(app);

      const productsSection = document.getElementById('productsSection');
      const searchInput = document.getElementById('searchInput');

      let allProducts = [];
      let currentModalProduct = null;
      let isLoading = true;

      const showSkeleton = () => {
        for (let i = 0; i < 8; i++) {
          const skeletonCard = document.createElement('div');
          skeletonCard.className = 'product skeleton';
          skeletonCard.innerHTML = `
            <div class="skeleton-image"></div>
            <div class="skeleton-text"></div>
            <div class="skeleton-text med"></div>
            <div class="skeleton-button"></div>
          `;
          productsSection.appendChild(skeletonCard);
        }
      };

      const loadProducts = async () => {
        showSkeleton();
        try {
          const querySnapshot = await getDocs(collection(db, 'products'));
          allProducts = [];
          querySnapshot.forEach((docSnap) => allProducts.push(docSnap.data()));
          isLoading = false;
          renderProducts(allProducts);
        } catch (error) {
          console.error("Error al cargar productos:", error);
          productsSection.innerHTML = "<p>Error al cargar productos.</p>";
        }
      };

      const renderProducts = (productArray) => {
        if (isLoading) return;
        productsSection.innerHTML = '';
        if (productArray.length === 0) {
          productsSection.innerHTML = "<p>No hay productos que coincidan con tu búsqueda.</p>";
          return;
        }

        productArray.forEach((productData, index) => {
          const imgURL = productData.image || 'https://via.placeholder.com/150';
          const priceNumber = Number(productData.price);
          const productEl = document.createElement('div');
          productEl.className = 'product';
          productEl.setAttribute('data-index', index);

          productEl.innerHTML = `
              <img src="${imgURL}" alt="${productData.title}" class="product-img">
              <h3>${productData.title}</h3>
              <div class="details">
                ${productData.sagitario ? `<div><strong>Marca/Línea:</strong> ${productData.sagitario}</div>` : ''}
                ${productData.description ? `<div><strong>Descripción:</strong> ${productData.description}</div>` : ''}
              </div>
              <p class="price">$${priceNumber.toFixed(2)}</p>
              <button data-name="${productData.title}" data-price="${priceNumber}" data-image="${imgURL}">
                <i class="fas fa-cart-plus"></i> Agregar
              </button>
          `;
          productsSection.appendChild(productEl);
        });
      };

      const filterProducts = () => {
        if (isLoading) return;
        const searchText = searchInput.value.toLowerCase();
        const filtered = allProducts.filter(prod => {
          const matchesName = prod.title?.toLowerCase().includes(searchText) || prod.description?.toLowerCase().includes(searchText);
          return matchesName;
        });
        renderProducts(filtered);
      };

      searchInput.addEventListener('input', filterProducts);
      loadProducts();

      // Modal de producto
      const productModalOverlay = document.getElementById('productModalOverlay');
      const modalProductImg = document.getElementById('modalProductImg');
      const modalProductName = document.getElementById('modalProductName');
      const modalProductDetails = document.getElementById('modalProductDetails');
      const modalProductPrice = document.getElementById('modalProductPrice');
      const modalAddToCartBtn = document.getElementById('modalAddToCartBtn');
      const closeProductModalBtn = document.getElementById('closeProductModalBtn');

      const openProductModal = (product) => {
        modalProductImg.src = product.image || 'https://via.placeholder.com/150';
        modalProductName.textContent = product.title;
        const detailsArr = [];
        if (product.sagitario) detailsArr.push(`Marca/Línea: ${product.sagitario}`);
        if (product.description) detailsArr.push(`Descripción: ${product.description}`);
        modalProductDetails.innerHTML = detailsArr.map(d => `<div>${d}</div>`).join('') || '<div>Sin detalles adicionales</div>';
        modalProductPrice.textContent = `$${Number(product.price).toFixed(2)}`;
        productModalOverlay.classList.add('open');
      };

      const closeProductModal = () => {
        productModalOverlay.classList.remove('open');
      };

      closeProductModalBtn.addEventListener('click', closeProductModal);
      productModalOverlay.addEventListener('click', (e) => {
        if (e.target === productModalOverlay) closeProductModal();
      });

      modalAddToCartBtn.addEventListener('click', () => {
        if (currentModalProduct) {
          const { title, price, image } = currentModalProduct;
          addToCart(title, Number(price), image || 'https://via.placeholder.com/150');
          closeProductModal();
        }
      });

      // Carrito
      const cartModal = document.getElementById('cartModal');
      const cartItemsContainer = document.getElementById('cartItems');
      const checkoutBtn = document.getElementById('checkoutBtn');
      const closeCartBtn = document.getElementById('closeCartBtn');
      const cartButton = document.getElementById('cartButton');
      const toast = document.getElementById('toast');

      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      const saveCartToLocalStorage = () => {
        localStorage.setItem('cart', JSON.stringify(cart));
      };

      const updateCartDOM = () => {
        cartItemsContainer.innerHTML = '';
        cart.forEach((item) => {
          const priceNumber = Number(item.price);
          const cartItem = document.createElement('div');
          cartItem.className = 'cart-item';
          cartItem.innerHTML = `
              <img src="${item.image}" alt="${item.name}">
              <div>
                  <p><strong>${item.name}</strong></p>
                  <p>$${priceNumber.toFixed(2)}</p>
              </div>
          `;
          cartItemsContainer.appendChild(cartItem);
        });
        cartButton.innerHTML = `<i class="bi bi-cart-plus"></i> Carrito (${cart.length})`;
      };

      updateCartDOM();

      const showToast = (message) => {
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 2000);
      };

      const addToCart = (name, price, image) => {
        cart.push({ name, price, image });
        saveCartToLocalStorage();
        updateCartDOM();
        showToast("Producto agregado al carrito!");
      };

      cartButton.addEventListener('click', () => {
        cartModal.classList.toggle('open');
      });

      closeCartBtn.addEventListener('click', () => {
        cartModal.classList.remove('open');
      });

      // Al finalizar compra, redirigir a WhatsApp con el mensaje de los productos
      checkoutBtn.addEventListener('click', () => {
        if (cart.length === 0) {
          showToast('No hay productos en el carrito.');
          return;
        }

        let message = "Hola, estos son los productos que deseo comprar:%0A";
        cart.forEach(item => {
          message += `- ${item.name} por $${item.price.toFixed(2)}%0A`;
        });

        // Vaciar el carrito antes de redirigir
        cart = [];
        saveCartToLocalStorage();
        updateCartDOM();

        // Redirigir a WhatsApp con el mensaje
        window.location.href = `https://wa.me/51944654438?text=${message}`;
      });

      // Delegación de eventos para agregar al carrito desde productsSection
      productsSection.addEventListener('click', (e) => {
        const productCard = e.target.closest('.product');
        if (!productCard) return;

        if (productCard.classList.contains('skeleton')) return;

        if (e.target.closest('button')) {
          e.stopPropagation();
          const button = e.target.closest('button');
          const name = button.getAttribute('data-name');
          const price = Number(button.getAttribute('data-price'));
          const image = button.getAttribute('data-image');
          const imgElement = productCard.querySelector('img');
          flyToCart(imgElement, name, price, image);
        } else {
          // Abrir modal de producto
          const index = productCard.getAttribute('data-index');
          currentModalProduct = (index !== null) ? allProducts[index] : null;
          if (currentModalProduct) openProductModal(currentModalProduct);
        }
      });

      const flyToCart = (imgElement, name, price, image) => {
        const rect = imgElement.getBoundingClientRect();
        const cartRect = cartButton.getBoundingClientRect();
        const flyingImg = imgElement.cloneNode(true);
        flyingImg.className = 'flying-img';
        flyingImg.style.top = rect.top + 'px';
        flyingImg.style.left = rect.left + 'px';
        flyingImg.style.width = rect.width + 'px';
        flyingImg.style.height = rect.height + 'px';
        document.body.appendChild(flyingImg);

        requestAnimationFrame(() => {
          flyingImg.style.transform = `translate(${cartRect.left - rect.left + cartRect.width/2 - rect.width/2}px, ${cartRect.top - rect.top + cartRect.height/2 - rect.height/2}px) scale(0.1)`;
        });

        flyingImg.addEventListener('transitionend', () => {
          flyingImg.remove();
          addToCart(name, price, image);
        }, { once: true });
      };

      // Rotación de imágenes del banner
      const bannerImages = document.querySelectorAll('.banner .banner-image-container img');
      let currentImageIndex = 0;
      const totalImages = bannerImages.length;

      setInterval(() => {
        bannerImages[currentImageIndex].classList.remove('active');
        currentImageIndex = (currentImageIndex + 1) % totalImages;
        bannerImages[currentImageIndex].classList.add('active');
      }, 5000);
    </script>
</body>
</html>
